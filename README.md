# advertisingMachine

## 开发环境
- 硬件部分：GEC6818开发平台;
- 交叉编译器：用于 ARM 架构的嵌入式 Linux 系统，版本为 GCC 5.4.0，使用 Buildroot 2016.11 进行配置和构建;
- 项目构建：GNU Make 4.2.1
- 操作系统：Ubuntu 20.04 LTS

## 介绍
本项目基于GEC6818开发平台，实现一个播放 **.avi格式的视频** 或者切换显示 **24位.bmp格式的图片**的终端设备；利用TCP/IP实现linux端服务器可以与设备进行通信，设备按照传输的命令，执行包括但不限于切换视频，暂停/继续播放视频，传送图片或者视频显示。
- server/tcp_send为虚拟机运行的服务端
- out/main为开发板运行的客户端

## 注意
在yq/sendMessage内代码中
1. 在连续两次send之间，务必确保客户端已经将接收的数据写入文件后再发送停止符。为了保险起见，建议等待至少10毫秒（ms）。在原始代码中，使用了较粗暴的解决方案：
```c
usleep(10000);
```
可以替换为以下两种更为合理的解决方案：

- 消息长度前缀： 在每个消息的前面添加一个表示消息长度的固定字节数。接收端首先读取这个长度，然后知道后续的数据属于一个完整的消息。

- 消息结束符： 在每个消息的末尾添加一个特殊的标记，表示消息结束。接收端通过检测这个标记来确定消息的结束。  

2. 注意使用strlen计算长度时不包含\0，因此需要对长度进行偏移一位，防止接收端在接收时出现问题：
```c
size_t filenameLength = strlen(filename) + 1;
```
需要确保发送端和接收端都按照相同的规则来处理数据，以确保消息的正确解析和处理